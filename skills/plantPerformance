 
module.exports = function (controller) {

    controller.hears([/plant performance\b/], 'direct_message,direct_mention', function (bot, message) {
    
        var request = require('request');
        request('http://194.79.57.109:8080/SFapi/machines', function (error, response, body) {
          console.log('error:', error); // Print the error if one occurred
          console.log('statusCode:', response && response.statusCode); // Print the response status code if a response was received
          console.log('body:', body); // Print the HTML for the Google homepage.
          
          var jsonData = JSON.parse(body);
          for (var i = 0; i < jsonData.length; i++) {
              var counter = jsonData.machines[i];
              console.log(counter.machine.oee);
          }
        });
    
         
    
      bot.startConversation(message, function (err, convo) {

            convo.ask("Do you want more details? (Please, choose yes|no)", [
                {
                    pattern: "^yes|ok$",
                    convo.gotoThread("yes");
                    },
                },
				        {
                    pattern: "^no$",
                    callback: function (response, convo) {
                         convo.transitionTo("no");
                    },
                },
                {
                    default: true,
                    callback: function (response, convo) {
                        convo.transitionTo("default", "Got it, let's try again...");
                    }
                }
            ], {}, "choice");

             

            // Yes thread
            convo.addMessage(
                "Line1:\nLine2\n",
                "yes");
				
				// no thread
            convo.addMessage(
                "Glad having been helped you",
                "no");
        });
    });

    });
};

